<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat with Status Updates</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .chat-container {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }

      input[type="text"],
      textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        box-sizing: border-box;
      }

      button {
        background-color: #007cba;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }

      button:hover {
        background-color: #005a8b;
      }

      button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
      }

      .status-container {
        margin: 20px 0;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 4px;
        border-left: 4px solid #007cba;
      }

      .status-step {
        display: flex;
        align-items: center;
        margin: 8px 0;
        padding: 8px;
        border-radius: 4px;
        background: white;
      }

      .status-step.executing {
        border-left: 3px solid #ffc107;
        background-color: #fff8e1;
      }

      .status-step.completed {
        border-left: 3px solid #28a745;
        background-color: #f0fff4;
      }

      .status-step.failed {
        border-left: 3px solid #dc3545;
        background-color: #fff5f5;
      }

      .step-number {
        background: #007cba;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        margin-right: 10px;
        flex-shrink: 0;
      }

      .step-description {
        flex-grow: 1;
        margin-right: 10px;
      }

      .step-status {
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 12px;
        text-transform: uppercase;
        font-weight: bold;
      }

      .step-status.executing {
        background-color: #ffc107;
        color: #856404;
      }

      .step-status.completed {
        background-color: #28a745;
        color: white;
      }

      .step-status.failed {
        background-color: #dc3545;
        color: white;
      }

      .step-time {
        margin-left: 10px;
        color: #666;
        font-size: 11px;
      }

      .response-container {
        margin: 20px 0;
        padding: 15px;
        background-color: #e3f2fd;
        border-radius: 4px;
        border-left: 4px solid #2196f3;
      }

      .execution-summary {
        margin: 20px 0;
        padding: 10px;
        background-color: #f0f0f0;
        border-radius: 4px;
        font-size: 14px;
      }

      .error-message {
        margin: 20px 0;
        padding: 15px;
        background-color: #ffebee;
        border-radius: 4px;
        border-left: 4px solid #f44336;
        color: #c62828;
      }

      .loading-indicator {
        display: none;
        text-align: center;
        margin: 20px 0;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #007cba;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="chat-container">
      <h1>Travel Assistant with Status Updates</h1>

      <form id="chat-form">
        <div class="form-group">
          <label for="user-query">Ask me about travel destinations:</label>
          <input
            type="text"
            id="user-query"
            placeholder="e.g., What are the best places to visit in Tokyo?"
            required
          />
        </div>
        <button type="submit" id="submit-btn">Ask Question</button>
      </form>

      <div id="loading-indicator" class="loading-indicator hidden">
        <div class="spinner"></div>
        <p>Processing your request...</p>
      </div>

      <div id="chat-status" class="status-container hidden">
        <h3>Processing Status:</h3>
      </div>

      <div id="chat-response" class="response-container hidden">
        <h3>Response:</h3>
        <div id="response-content"></div>
      </div>

      <div id="execution-summary" class="execution-summary hidden"></div>

      <div id="chat-error" class="error-message hidden"></div>
    </div>

    <script>
      // Simple implementation for demonstration
      async function submitQuery() {
        const query = document.getElementById("user-query").value.trim();
        if (!query) return;

        // Show loading state
        document.getElementById("loading-indicator").classList.remove("hidden");
        document.getElementById("submit-btn").disabled = true;

        // Clear previous results
        [
          "chat-status",
          "chat-response",
          "execution-summary",
          "chat-error",
        ].forEach((id) => {
          const element = document.getElementById(id);
          element.classList.add("hidden");
          element.innerHTML = "";
        });

        try {
          // Simulate the status updates you would receive from your API
          await simulateStatusUpdates(query);
        } catch (error) {
          showError(error.message);
        } finally {
          document.getElementById("loading-indicator").classList.add("hidden");
          document.getElementById("submit-btn").disabled = false;
        }
      }

      async function simulateStatusUpdates(query) {
        const statusContainer = document.getElementById("chat-status");
        statusContainer.classList.remove("hidden");

        const steps = [
          {
            step: 1,
            description: "Analyzing your query and preparing request",
            status: "executing",
          },
          {
            step: 1,
            description: "Query prepared, calling OpenAI",
            status: "completed",
          },
          {
            step: 2,
            description: "Waiting for OpenAI response",
            status: "executing",
          },
          {
            step: 2,
            description: "Received initial response from OpenAI",
            status: "completed",
          },
          {
            step: 3,
            description: "Executing web_search_call",
            status: "executing",
          },
          {
            step: 3,
            description: "Searching the web for relevant information",
            status: "executing",
          },
          { step: 3, description: "Web search completed", status: "completed" },
          {
            step: 4,
            description: "Sending tool results back to OpenAI",
            status: "executing",
          },
          {
            step: 4,
            description: "Received final response from OpenAI",
            status: "completed",
          },
          {
            step: 5,
            description: "Response generation completed",
            status: "completed",
          },
        ];

        for (let i = 0; i < steps.length; i++) {
          await new Promise((resolve) => setTimeout(resolve, 500)); // Simulate delay
          addStatusStep(steps[i], statusContainer);
        }

        // Simulate final response
        await new Promise((resolve) => setTimeout(resolve, 500));
        showFinalResponse(query);
      }

      function addStatusStep(step, container) {
        const stepElement = document.createElement("div");
        stepElement.className = `status-step ${step.status}`;
        stepElement.innerHTML = `
                <span class="step-number">${step.step}</span>
                <span class="step-description">${step.description}</span>
                <span class="step-status ${step.status}">${step.status}</span>
                <small class="step-time">${new Date().toLocaleTimeString()}</small>
            `;
        container.appendChild(stepElement);
      }

      function showFinalResponse(query) {
        const responseContainer = document.getElementById("chat-response");
        const responseContent = document.getElementById("response-content");
        const summaryContainer = document.getElementById("execution-summary");

        responseContainer.classList.remove("hidden");
        summaryContainer.classList.remove("hidden");

        // Simulate a travel response
        responseContent.innerHTML = `
                <div>
                    <p><strong>Here are some great places to visit based on your query "${query}":</strong></p>
                    <ul>
                        <li><strong>Cultural District:</strong> Traditional temples and museums</li>
                        <li><strong>Food Markets:</strong> Local cuisine and street food</li>
                        <li><strong>Nature Parks:</strong> Beautiful gardens and walking trails</li>
                    </ul>
                    <p>Would you like more specific recommendations for any of these areas?</p>
                </div>
            `;

        summaryContainer.innerHTML = `
                <div class="execution-summary">
                    <p><strong>Execution Summary:</strong></p>
                    <p>âœ… Execution completed in 3,247ms</p>
                    <p>ðŸ”§ Tools used: web_search_call</p>
                    <p>ðŸ“Š Steps completed: 10</p>
                </div>
            `;
      }

      function showError(message) {
        const errorContainer = document.getElementById("chat-error");
        errorContainer.classList.remove("hidden");
        errorContainer.innerHTML = `
                <div class="error-message">
                    <strong>Error:</strong> ${message}
                </div>
            `;
      }

      // Setup form handler
      document.getElementById("chat-form").addEventListener("submit", (e) => {
        e.preventDefault();
        submitQuery();
      });
    </script>
  </body>
</html>
